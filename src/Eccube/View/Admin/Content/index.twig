{% extends 'Admin/main_frame.twig' %}

{% block main %}

<script type="text/javascript">//<![CDATA[
    $(function() {
        var bread_crumbs = '{{ now_dir|default('') }}';
        var file_path = '{{ top_dir }}';
        var $delimiter = '<span>&nbsp;&gt;&nbsp;</span>';
        var $node = $('h2');
        var total = bread_crumbs.length;
        for (var i in bread_crumbs) {
            file_path += bread_crumbs[i] + '/';
            $('<a href="javascript:;" onclick="eccube.fileManager.openFolder(\'' + file_path + '\'); return false;" />')
                .text(bread_crumbs[i])
                .appendTo($node);
            if (i < total - 1) $node.append($delimiter);
        }
    });

    eccube.fileManager.IMG_FOLDER_CLOSE   = "{{ app.config.admin_tpl }}img/contents/folder_close.gif";  // フォルダクローズ時画像
    eccube.fileManager.IMG_FOLDER_OPEN    = "{{ app.config.admin_tpl }}img/contents/folder_open.gif";   // フォルダオープン時画像
    eccube.fileManager.IMG_PLUS           = "{{ app.config.admin_tpl }}img/contents/plus.gif";          // プラスライン
    eccube.fileManager.IMG_MINUS          = "{{ app.config.admin_tpl }}img/contents/minus.gif";         // マイナスライン
    eccube.fileManager.IMG_NORMAL         = "{{ app.config.admin_tpl }}img/contents/space.gif";         // スペース
//]]></script>


<div id="admin-contents" class="contents-main">
    <div id="contents-filemanager-tree">
        <div id="tree">
        </div>
    </div>
    <div id="contents-filemanager-right">
        <table class="now_dir">
            <tr>
                <th>ファイルのアップロード</th>
                <td>
                    <input type="file" name="upload_file" size="40" />
                    <a class="btn-normal" href="javascript:;" onclick="eccube.fileManager.setTreeStatus('tree_status');eccube.setModeAndSubmit('upload','',''); return false;">アップロード</a>
                </td>
            </tr>
            <tr>
                <th>フォルダ作成</th>
                <td>
                    <input type="text" name="create_file" value="" style="width:336px;" />
                    <a class="btn-normal" href="javascript:;" onclick="eccube.fileManager.setTreeStatus('tree_status');eccube.setModeAndSubmit('create','',''); return false;">作成</a>
                </td>
            </tr>
        </table>

        <h2>{# jQuery で挿入されるパンくず部分 #}</h2>
        <table class="list">
            <tr>
                <th>ファイル名</th>
                <th>サイズ</th>
                <th>更新日付</th>
                <th class="edit">表示</th>
                <th>ダウンロード</th>
                <th class="delete">削除</th>
            </tr>
            <!--{if !$tpl_is_top_dir}-->
                <tr id="parent_dir" onclick="eccube.setValue('select_file', '<!--{$tpl_parent_dir|h}-->', 'form1'); eccube.fileManager.selectFile('parent_dir', '#808080');" onDblClick="eccube.fileManager.setTreeStatus('tree_status');eccube.fileManager.toggleTreeMenu('tree'+cnt, 'rank_img'+cnt, arrTree[cnt][2]);eccube.fileManager.doubleClick(arrTree, '<!--{$tpl_parent_dir|h}-->', true, '<!--{$tpl_now_dir|h}-->', true)" style="">
                    <td>
                        <img src="{{ app.config.admin_tpl }}img/contents/folder_parent.gif" alt="フォルダ">&nbsp;..
                    </td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
            <!--{/if}-->
            <!--{section name=cnt loop=$arrFileList}-->
                <!--{assign var="id" value="select_file`$smarty.section.cnt.index`"}-->
                <tr id="<!--{$id}-->" style="">
                    <td class="file-name" onDblClick="eccube.fileManager.setTreeStatus('tree_status');eccube.fileManager.doubleClick(arrTree, '<!--{$arrFileList[cnt].file_path|h}-->', <!--{if $arrFileList[cnt].is_dir|h}-->true<!--{else}-->false<!--{/if}-->, '<!--{$tpl_now_dir|h}-->', false)">
                        <!--{if $arrFileList[cnt].is_dir}-->
                            <img src="{{ app.config.admin_tpl }}img/contents/folder_close.gif" alt="フォルダ" />
                        <!--{else}-->
                            <img src="{{ app.config.admin_tpl }}img/contents/file.gif" />
                        <!--{/if}-->
                        <!--{$arrFileList[cnt].file_name|h}-->
                    </td>
                    <td class="right">
                        <!--{$arrFileList[cnt].file_size|n2s}-->
                    </td>
                    <td class="center">
                        <!--{$arrFileList[cnt].file_time|h}-->
                    </td>
                    <!--{if $arrFileList[cnt].is_dir}-->
                        <td class="center">
                            <a href="javascript:;" onclick="eccube.setValue('tree_select_file', '<!--{$arrFileList[cnt].file_path}-->', 'form1'); eccube.fileManager.selectFile('<!--{$id}-->', '#808080');eccube.setModeAndSubmit('move','',''); return false;">表示</a>
                        </td>
                    <!--{else}-->
                        <td class="center">
                            <a href="javascript:;" onclick="eccube.setValue('select_file', '<!--{$arrFileList[cnt].file_path|h}-->', 'form1');eccube.fileManager.selectFile('<!--{$id}-->', '#808080');eccube.setModeAndSubmit('view','',''); return false;">表示</a>
                        </td>
                    <!--{/if}-->
                    <!--{if $arrFileList[cnt].is_dir}-->
                        <!--{* ディレクトリはダウンロード不可 *}-->
                        <td class="center">-</td>
                    <!--{else}-->
                        <td class="center">
                            <a href="javascript:;" onclick="eccube.setValue('select_file', '<!--{$arrFileList[cnt].file_path|h}-->', 'form1');eccube.fileManager.selectFile('<!--{$id}-->', '#808080');eccube.fileManager.setTreeStatus('tree_status');eccube.setModeAndSubmit('download','',''); return false;">ダウンロード</a>
                        </td>
                    <!--{/if}-->
                    <td class="center">
                        <a href="javascript:;" onclick="eccube.setValue('select_file', '<!--{$arrFileList[cnt].file_path|h}-->', 'form1');eccube.fileManager.selectFile('<!--{$id}-->', '#808080');eccube.fileManager.setTreeStatus('tree_status');eccube.setModeAndSubmit('delete','',''); return false;">削除</a>
                    </td>
                </tr>
            <!--{/section}-->
        </table>
    </div>
</div>


{% endblock %}